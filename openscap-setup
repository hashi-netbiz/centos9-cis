### [1] Install the required packages:
        dnf -y install openscap-scanner scap-security-guide

### [2] SCAP Security Guide is installed under the [/usr/share/xml/scap/ssg/content] directory: 
        ll /usr/share/xml/scap/ssg/content/ 

### [3] display description for each content:
        oscap info /usr/share/xml/scap/ssg/content/ssg-cs9-ds.xml 
        
### [4] Scan CentOS System with [oscap] command. This based on server level 1 security checks only
        Scan result is generated as HTML report, verify it and try to apply recommended settings as much as possible:
        oscap xccdf eval \
        --profile xccdf_org.ssgproject.content_profile_cis_server_l1 \
        --results ssg-cs9-ds.xml \
        --report ssg-cs9-ds.html \
        --fetch-remote-resources \
        /usr/share/xml/scap/ssg/content/ssg-cs9-ds.xml 

### [5] Check the html report and rename as ssg-cs9-ds-old.html.

### [6] generate remediation script from scaned result.
        Remediation script will change various system settings, so you must take care if you run it, especially for production systems.
       
        ## make sure the [Result ID] in the result output on [4]
        oscap info ssg-cs9-ds.xml | grep "Result ID" 
        
        ## generate remediation script
        oscap xccdf generate fix \
        --fix-type ansible \
        --output ssg-cs9-ds-remediation-playbook.yml \
        --result-id xccdf_org.open-scap_testresult_xccdf_org.ssgproject.content_profile_cis_server_l1 \   
        ssg-cs9-ds.xml 
        
        # run remediation script
        # install ansible 
        dnf install ansible-core -y
        
        # update hosts file
        cat << 'EOF' >> /etc/ansible/hosts
        localhost ansible_connection=local
        EOF

        # execute ansible playbook to install CIS benchmarks and remediate
        ansible-playbook './ssg-cs9-ds-remediation-playbook.yml'
        
 ### [7] Re-run the HTML report and check the result:
        oscap xccdf eval \
        --profile xccdf_org.ssgproject.content_profile_cis_server_l1 \
        --results ssg-cs9-ds.xml \
        --report ssg-cs9-ds.html \
        --fetch-remote-resources \
        /usr/share/xml/scap/ssg/content/ssg-cs9-ds.xml 
       
